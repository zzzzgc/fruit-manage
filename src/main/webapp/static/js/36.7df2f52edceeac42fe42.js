webpackJsonp([36],{ACNQ:function(t,e,r){"use strict";var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-dialog",{attrs:{title:"客户添加/编辑",width:"80%",visible:t.showDialog,"close-on-click-modal":!1},on:{"update:visible":function(e){return t.$emit("update:showDialog",e)},close:t.reset,open:t.show}},[r("el-form",{ref:"form",attrs:{form:t.form,model:t.form,"label-width":"100px","label-position":"right"}},[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{size:"mini",label:"客户"}},[t.isEdit?r("div",[t._v("\n            "+t._s(t.form.business_name)+"\n          ")]):r("el-select",{attrs:{disabled:t.isEdit,filterable:"",placeholder:"请选择"},on:{change:t.selectCustomer},model:{value:t.form.business_user_id,callback:function(e){t.$set(t.form,"business_user_id",e)},expression:"form.business_user_id"}},t._l(t.tempCustomerInfo,function(t){return r("el-option",{key:t.id,attrs:{label:t.business_name,value:t.id}})}))],1)],1),t._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{size:"mini",label:"销售",prop:"a_user_sales"}},[t._v("\n          "+t._s(null==t.form.a_user_sales?"暂无":t.form.a_user_sales)+"\n        ")])],1),t._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{size:"mini",label:"配送时间"}},[t._v("\n          早上 8:00 - 10:00\n        ")])],1),t._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{size:"mini",label:"配送方式",prop:"group_key"}},[t._v("\n          "+t._s(null==t.form.delivery_type?"暂无":t.shipmentTypeStore.shipmentTypeList[t.form.delivery_type])+"\n        ")])],1),t._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{size:"mini",label:"收货人"}},[t._v("\n          "+t._s(null==t.form.buy_user_name?"暂无":t.form.buy_user_name)+"\n        ")])],1),t._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{size:"mini",label:"收货地址"}},[t._v("\n          "+t._s(null==t.form.buy_address?"暂无":t.form.buy_address)+"\n        ")])],1)],1),t._v(" "),r("hr"),t._v(" "),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{size:"mini",label:"订单号"}},[t._v("\n          "+t._s(null==t.form.order_id?"暂无":t.form.order_id)+"\n        ")])],1),t._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{size:"mini",label:"订单状态"}},[t._v("\n          "+t._s(null==t.form.order_status?"暂无":t.orderStatusStore.orderStatusList[t.form.order_status])+"\n        ")])],1),t._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{size:"mini",label:"下单时间"}},[t._v("\n          "+t._s(null==t.form.create_time?"暂无":t.form.create_time)+"\n        ")])],1),t._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{staticStyle:{color:"red"},attrs:{size:"mini",label:"下单总额"}},[t._v("\n          ￥"+t._s(null==t.form.pay_need_money?"暂无":t.form.pay_need_money)+"\n        ")])],1),t._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{size:"mini",label:"公司货损额"}},[t._v("\n          暂无\n        ")])],1),t._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{staticStyle:{color:"red"},attrs:{size:"mini",label:"应收总额"}},[t._v("\n          ￥"+t._s(null==t.form.pay_reality_need_money?"0":void 0===t.form.pay_reality_need_money?"0":t.form.pay_reality_need_money)+"\n        ")])],1)],1),t._v(" "),r("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{size:"mini",type:"primary"},on:{click:t.onAddProduct}},[t._v("添加商品")]),t._v(" "),r("el-row",t._l(t.form.products,function(e){return r("el-col",{key:e.product_standard_id,staticStyle:{border:"1px solid #eeeeee",padding:"10px"},attrs:{gutter:10,span:6}},[r("el-form-item",{attrs:{"label-width":"50px",size:"mini",label:"商品"}},[t._v("\n\n          "+t._s(e.product_name)+"\n\n        ")]),t._v(" "),r("el-form-item",{attrs:{"label-width":"55px",size:"mini",label:"规格"}},[t._v("\n\n          "+t._s(e.product_standard_name)+"\n        ")]),t._v(" "),r("el-form-item",{attrs:{"label-width":"55px",size:"mini",label:"副标题"}},[t._v("\n          "+t._s(e.sub_title)+"\n        ")]),t._v(" "),r("el-form-item",{attrs:{"label-width":"55px",size:"mini",label:"数量"}},[r("el-input",{attrs:{size:"mini",placeholder:"请输入数量"},model:{value:e.num,callback:function(r){t.$set(e,"num",r)},expression:"product.num"}})],1),t._v(" "),null!=t.form.order_status&&""!=t.form.order_status&&0!=t.form.order_status&&5!=t.form.order_status?r("el-form-item",{attrs:{"label-width":"55px",size:"mini",label:"实发数"}},[r("el-input",{attrs:{size:"mini",placeholder:"请输入数量"},model:{value:e.actual_send_goods_num,callback:function(r){t.$set(e,"actual_send_goods_num",r)},expression:"product.actual_send_goods_num"}})],1):t._e(),t._v(" "),null!=t.form.order_status&&""!=t.form.order_status&&0!=t.form.order_status&&5!=t.form.order_status&&10!=t.form.order_status&&15!=t.form.order_status?r("el-form-item",{attrs:{"label-width":"55px",size:"mini",label:"实收数"}},[r("el-input",{attrs:{size:"mini",placeholder:"请输入数量"},model:{value:e.actual_deliver_num,callback:function(r){t.$set(e,"actual_deliver_num",r)},expression:"product.actual_deliver_num"}})],1):t._e(),t._v(" "),r("el-form-item",{attrs:{"label-width":"55px",size:"mini",label:"报价"}},[t._v("\n          "+t._s(e.original_price)+"\n        ")]),t._v(" "),r("el-form-item",{attrs:{"label-width":"55px",size:"mini",label:"单价"}},[r("el-input",{attrs:{size:"mini",placeholder:"请输入单价"},model:{value:e.sell_price,callback:function(r){t.$set(e,"sell_price",r)},expression:"product.sell_price"}})],1),t._v(" "),r("el-form-item",{attrs:{"label-width":"55px",size:"mini",label:"备注"}},[r("el-input",{attrs:{type:"textarea",placeholder:"请输入备注"},model:{value:e.buy_remark,callback:function(r){t.$set(e,"buy_remark",r)},expression:"product.buy_remark"}})],1),t._v(" "),r("el-button",{staticStyle:{width:"100%"},attrs:{type:"danger",size:"mini"},on:{click:function(r){t.removeProduct(e)}}},[t._v("删除")])],1)}))],1),t._v(" "),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.submitAddAndEdit}},[t._v("确认")]),t._v(" "),r("el-button",{attrs:{size:"mini"},on:{click:function(e){t.$emit("update:showDialog",!1)}}},[t._v("取消")])],1),t._v(" "),r("el-dialog",{attrs:{center:!0,modal:!1,title:"添加商品",visible:t.on_off.isAddProduct},on:{"update:visible":function(e){t.$set(t.on_off,"isAddProduct",e)},close:t.addProductReset,open:t.addProductShow}},[r("el-form",[r("el-form-item",{attrs:{"label-width":"70px",size:"mini",label:"商品"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"","remote-method":t.productSearch,placeholder:"请输入关键词",loading:t.on_off.tempProductInfoLoading},on:{change:t.selectProduct},model:{value:t.tempProduct.product_id,callback:function(e){t.$set(t.tempProduct,"product_id",e)},expression:"tempProduct.product_id"}},t._l(t.tempProductsInfo,function(t){return r("el-option",{key:t.product_id,attrs:{label:t.product_name+"["+t.brand+"]",value:t.product_id}})}))],1),t._v(" "),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.tempProduct.product_id,expression:"tempProduct.product_id"}],attrs:{"label-width":"70px",size:"mini",label:"规格"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入关键词"},on:{change:t.selectProductStandard},model:{value:t.tempProduct.product_standard_id,callback:function(e){t.$set(t.tempProduct,"product_standard_id",e)},expression:"tempProduct.product_standard_id"}},t._l(t.tempProductStandardsInfo,function(t){return r("el-option",{key:t.product_standard_id,attrs:{label:t.product_standard_name+"["+t.product_standard_id+"]",value:t.product_standard_id}})}))],1),t._v(" "),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.tempProduct.product_standard_id,expression:"tempProduct.product_standard_id"}],attrs:{"label-width":"70px",size:"mini",label:"副标题"}},[t._v("\n        "+t._s(t.tempProduct.sub_title)+"\n      ")]),t._v(" "),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.tempProduct.product_standard_id,expression:"tempProduct.product_standard_id"}],attrs:{"label-width":"70px",size:"mini",label:"报价"}},[t._v("\n        "+t._s(t.tempProduct.original_price)+"\n      ")]),t._v(" "),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.tempProduct.product_standard_id,expression:"tempProduct.product_standard_id"}],attrs:{"label-width":"70px",size:"mini",label:"单价"}},[t._v("\n        "+t._s(t.tempProduct.sell_price)+"\n      ")])],1),t._v(" "),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.addProduct}},[t._v("确认")]),t._v(" "),r("el-button",{attrs:{size:"mini"},on:{click:t.addProductCancel}},[t._v("取消")])],1)],1)],1)},s=[],i={render:o,staticRenderFns:s};e.a=i},Amh9:function(t,e,r){var o=r("eatj");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);r("rjj0")("35b744e0",o,!0)},eatj:function(t,e,r){e=t.exports=r("FZ+f")(!1),e.push([t.i,"",""])},gBiV:function(t,e,r){"use strict";function o(t){r("Amh9")}Object.defineProperty(e,"__esModule",{value:!0});var s=r("maXY"),i=r("ACNQ"),n=r("VU/8"),d=o,a=n(s.a,i.a,!1,d,"data-v-e57ad382",null);e.default=a.exports},maXY:function(t,e,r){"use strict";var o=r("mvHQ"),s=r.n(o),i=r("woOf"),n=r.n(i),d=r("Dd8w"),a=r.n(d),l=r("NYxO"),u=r("+UIE"),c=r("g7ZD");e.a={name:"add-or-edit",props:["showDialog","editRowId"],data:function(){return{isEdit:!1,form:{products:[]},resetForm:{products:[]},timeout:null,on_off:{isSelectProduct:!1,isAddProduct:!1,tempProductInfoLoading:!1},tempProduct:{},tempProductsInfo:[],tempProductStandardsInfo:[{}],tempCustomerInfo:[]}},mounted:function(){this.show(),this.init()},computed:Object(l.c)({shipmentTypeStore:"shipmentType",orderStatusStore:"orderStatus"}),methods:a()({},Object(l.b)({getShipmentTypeList:u.h,getOrderStatus:u.d}),{show:function(){var t=this;if(this.reset(),this.editRowId)return this.isEdit=!0,void this.$http.post("/manage/order/getOtherDataInfo",{orderId:this.editRowId}).then(function(e){t.form=e.data});this.isEdit=!1},reset:function(t){this.$refs.form&&this.$refs.form.resetFields(),this.form=n()({},this.resetForm),this.form.products=[],this.on_off.isSelectProduct=!1,this.tempProductStandardsInfo=[]},addProductReset:function(){this.tempProductStandardsInfo=[],this.tempProductsInfo=[],this.tempProduct={}},addProductShow:function(){this.addProductReset()},addProductCancel:function(){this.on_off.isAddProduct=!1,this.addProductReset()},removeProduct:function(t){var e=this;if(this.isEdit)this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.post("/manage/order/deleteProductForEdit",{orderDetailId:t.id}).then(function(r){var o=e.form.products.indexOf(t);-1!==o&&e.form.products.splice(o,1),e.successMsg("删除成功")})}).catch(function(){e.$message({type:"info",message:"已取消删除"})});else{var r=this.form.products.indexOf(t);-1!==r&&this.form.products.splice(r,1)}},addProductBefore:function(){var t=!1;return void 0===this.tempProduct.product_id||null===this.tempProduct.product_id||""===this.tempProduct.product_id?(t=!0,this.warningMsg("商品名不能为空")):void 0!==this.tempProduct.product_standard_id&&null!==this.tempProduct.product_standard_id&&""!==this.tempProduct.product_standard_id||(t=!0,this.warningMsg("商品规格不能为空")),t},addProduct:function(){this.addProductBefore()||(this.form.products.push(this.tempProduct),this.successMsg("成功添加商品"),this.on_off.isAddProduct=!1)},onAddProduct:function(){this.on_off.isAddProduct=!0},customerSearch:function(t,e){var r=this.tempCustomerInfo;e(t?r.filter(this.createFilter(t)):"不存在该客户")},productSearch:function(t){var e=this;""!==t?(this.on_off.tempProductInfoLoading=!0,this.$http.post("/manage/order/getProductInfoByQuery",{queryString:t}).then(function(t){e.on_off.tempProductInfoLoading=!1,e.tempProductsInfo=t.data})):this.tempProductsInfo=""},createFilter:function(t){return function(e){if(e.value)return 0===e.value.toLowerCase().indexOf(t.toLowerCase())}},init:function(){var t=this;console.log("开始初始化"),this.$http.post("/manage/order/getCustomers").then(function(e){console.log(e),t.tempCustomerInfo=e.data}),this.getShipmentTypeList()},selectCustomer:function(t){var e=this;console.log("customerId:"+t),this.$http.post("/manage/order/getCustomerInfo",{customerId:t}).then(function(t){e.form=n()({},e.form,t.data)})},calTotalNeedPayMoney:function(){var t=0;if(null!==this.form.products&&""!==this.form.products&&this.form.products.length>0)for(var e in this.form.products)/^\+?[1-9][0-9]*$/.test(this.form.products[e].num)||(this.form.products[e].num=1),/^[0-9]+(.[0-9]{1})?$/.test(this.form.products[e].sell_price)||(this.form.products[e].sell_price=1),t+=10*this.form.products[e].num*this.form.products[e].sell_price/10;return t},warningMsg:function(t){this.$message({message:t,type:"warning"})},successMsg:function(t){this.$message({message:t,type:"success"})},myTrim:function(t){return t.replace(/^\s+|\s+$/gm,"")},checkIsNull:function(t,e){var r=!0;return null!==t&&""!==t||(this.warningMsg(e),r=!1),r},submitBefore:function(){var t=!1;if(void 0===this.form.business_user_id||null===this.form.business_user_id||""===this.form.business_user_id)t=!0,this.warningMsg("请选择一个客户");else if(null!==this.form.products&&""!==this.form.products&&this.form.products.length>0){var e=0;for(var r in this.form.products)e=1+parseInt(r),void 0===this.form.products[r].product_name||null===this.form.products[r].product_name||""===this.myTrim(this.form.products[r].product_name)?(this.warningMsg("第"+e+"个商品名不能为空！"),t=!0):/^\+?[1-9][0-9]*$/.test(this.form.products[r].num)?/^[0-9]+(.[0-9]{1})?$/.test(this.form.products[r].sell_price)||(this.warningMsg("第"+e+"个商品的单价请输入正确的值，最多保留一位小数！"),t=!0):(this.warningMsg("第"+e+"个商品的数量输入有误！"),t=!0)}else t=!0,this.warningMsg("请至少添加一条商品");return t},submitAddAndEdit:function(){var t=this;this.submitBefore()||this.$http.post("/manage/order/save",n()({},this.form,{products:s()(this.form.products),orderId:this.editRowId})).then(function(e){t.$emit("update:showDialog",!1),t.editRowId?(t.successMsg("编辑数据成功"),c.c.$emit(c.e.edit)):(t.successMsg("添加数据成功"),c.c.$emit(c.e.add))})},selectProduct:function(t){var e=this;console.log("选中商品啦"),console.log(t);for(var r=this.tempProductsInfo,o=0;o<r.length;o++)if(r[o].product_id===t){this.tempProduct=n()({},this.tempProduct,r[o]);break}this.$http.post("/manage/order/getProductIdStandardsInfo",{productId:t}).then(function(t){console.log("获取商品规格信息"),console.log(t.data),e.tempProductStandardsInfo=t.data,e.on_off.isSelectProduct=!0})},selectProductStandard:function(t){for(var e=this.tempProductStandardsInfo,r=0;r<e.length;r++)if(e[r].product_standard_id===t){this.tempProduct=n()({},this.tempProduct,e[r]);break}}}),watch:{"form.products":{handler:function(t,e){var r=0;for(var o in t){var s=!1,i=!1;/^\+?[1-9][0-9]*$/.test(t[o].num)||(s=!0),/^[0-9]+(.[0-9]{1})?$/.test(t[o].sell_price)||(i=!0),r+=(!0===s?0:t[o].num)*(!0===i?0:10*t[o].sell_price)/10}this.form.pay_need_money=r},deep:!0}}}},mvHQ:function(t,e,r){t.exports={default:r("qkKv"),__esModule:!0}},qkKv:function(t,e,r){var o=r("FeBl"),s=o.JSON||(o.JSON={stringify:JSON.stringify});t.exports=function(t){return s.stringify.apply(s,arguments)}}});